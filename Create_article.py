from docx import Document
from docx.shared import Pt, Inches
from docx.oxml.ns import qn
from docx.enum.text import WD_PARAGRAPH_ALIGNMENT
from docx2pdf import convert
import json
from ChatGPT import ChatGPT
import os
import win32com.client as win32
import pythoncom

#short_article = "Tuberculosis (TB) is a highly contagious infectious disease caused by the bacterium Mycobacterium tuberculosis. It is one of the leading causes of death worldwide. The World Health Organization (WHO) is the leading international agency in the fight against TB. The WHO is committed to providing global leadership in the fight against TB by developing and implementing effective strategies to prevent, diagnose, and treat the disease. The most effective way to prevent TB is through vaccination. The WHO recommends the Bacille Calmette-Guérin (BCG) vaccine as the most effective vaccine for preventing TB in children. The BCG vaccine is given to children at birth or soon after birth. The vaccine helps to prevent severe forms of TB in children and can also reduce the risk of TB in adults. The WHO is also working to improve access to TB diagnosis and treatment. The WHO has developed a Global Plan to End TB, which includes initiatives to increase access to diagnosis and treatment, strengthen public health systems, and promote research and innovation. The Global Plan also includes initiatives to improve the quality of care for people with TB and to reduce the stigma associated with the disease.The symptoms of TB can vary depending on the type of TB and the person’s age and health status. Common symptoms of TB include a persistent cough, chest pain, fever, night sweats, and weight loss. If left untreated, TB can cause serious complications and death. The WHO is also playing a key role in improving global health. The WHO is working to promote access to healthcare, improve nutrition, reduce the spread of infectious diseases, and improve the quality of healthcare services around the world. The WHO is also working to reduce the burden of non-communicable diseases, such as cancer, diabetes, and cardiovascular disease. Vaccination is one of the most effective ways to protect against a wide range of diseases. Vaccines help to reduce the risk of serious illnesses and death from diseases like measles, polio, and whooping cough. Vaccination is especially important for middle-aged people, as they are more likely to be exposed to diseases due to their age and lifestyle. The WHO recommends that middle-aged people get vaccinated against a range of diseases, including influenza, measles, mumps, rubella, and whooping cough. The WHO also recommends that middle-aged people get vaccinated against pneumococcal disease, which can cause serious illnesses such as pneumonia and meningitis. The most effective vaccination programs for middle-aged people are those that are tailored to the individual’s age and health status. For example, people over the age of 65 may need additional vaccines, such as the shingles vaccine, to protect against shingles and other diseases. The WHO recommends that people over 65 get vaccinated against the flu, pneumococcal disease, hepatitis B, and human papillomavirus (HPV). The most up-to-date recommendations for vaccination for middle-aged people can be found on the WHO website. The WHO website provides detailed information about the recommended vaccines for middle-aged people, as well as information about the safety and effectiveness of the vaccines. The WHO also provides information about the cost of the vaccines, as well as information about where to get vaccinated. The WHO also provides information about the potential side effects of the vaccines. Side effects from the vaccines are generally mild and may include redness, swelling, or pain at the injection site. It is important to follow the instructions provided by your doctor or healthcare provider when getting vaccinated. Tuberculosis is a serious and potentially deadly disease, but it can be prevented and treated. The WHO is committed to providing global leadership in the fight against TB, and is working to improve access to diagnosis and treatment, strengthen public health systems, and promote research and innovation. Vaccination is an important part of protecting against TB and other diseases, and the WHO provides up-to-date recommendations for vaccination for middle-aged people. By following the WHO’s recommendations, middle-aged people can help protect themselves and their families from TB and other serious illnesses. In addition to following the WHO’s recommendations for vaccination, middle-aged people can also take steps to reduce their risk of TB. These steps include avoiding contact with someone who has active TB, practicing good hygiene, and getting regular checkups. It is also important to be aware of the signs and symptoms of TB, so that if you do develop the disease, you can seek treatment as soon as possible. By following the WHO’s recommendations for vaccination and taking steps to reduce their risk of TB, middle-aged people can help protect themselves and their families from TB and other serious illnesses. Vaccines are an important part of protecting against TB, and the WHO provides up-to-date recommendations for vaccination for middle-aged people. Following the WHO’s recommendations can help ensure that middle-aged people are protected against TB and other serious illnesses."
#long_article = "Tuberculosis (TB) is a highly contagious infectious disease caused by the bacterium Mycobacterium tuberculosis. It is one of the leading causes of death worldwide. The World Health Organization (WHO) is the leading international agency in the fight against TB. The WHO is committed to providing global leadership in the fight against TB by developing and implementing effective strategies to prevent, diagnose, and treat the disease. To do this, the WHO has established a Global TB Programme, which works to coordinate global efforts against TB. The programme focuses on four main areas: strengthening TB prevention and control; improving access to quality-assured diagnosis and treatment; promoting research and development; and engaging with communities and civil society. The programme also works to provide technical assistance and support to countries in their efforts to eliminate TB. It also works to raise awareness of TB and to reduce the stigma associated with the disease. The WHO is also working to develop new and improved diagnostics, drugs, and vaccines, as well as to increase access to these tools for people in need. In addition, the WHO is working to improve the quality of life of those affected by TB, by providing access to social protection and other services. The WHO is committed to ensuring that everyone has access to quality TB care and services, and to helping to end the TB epidemic once and for all.The most effective way to prevent TB is through vaccination. The WHO recommends the Bacille Calmette-Guérin (BCG) vaccine as the most effective vaccine for preventing TB in children. The BCG vaccine is given to children at birth or soon after birth. The vaccine helps to prevent severe forms of TB in children and can also reduce the risk of TB in adults. Vaccination is the key to preventing TB, and it is important to ensure that all children are vaccinated against the disease. Vaccinating children at birth or soon after birth is the best way to ensure that they are protected from TB. Vaccines are also available for adults, and it is important for adults to get vaccinated in order to reduce their risk of getting TB. Vaccination is the most effective way to protect people from TB, and it is important to ensure that everyone is vaccinated against the disease. Vaccines are also available for people who are at high risk of getting TB, such as those who are in close contact with someone who has the disease. Vaccinating these people is the best way to protect them from getting the disease. Vaccines are also available to help prevent the spread of TB, and it is important to ensure that everyone is vaccinated against the disease. Vaccines can help to reduce the spread of TB, and it is important to ensure that everyone is vaccinated against the disease. Vaccines can help to reduce the severity of TB, and it is important to ensure that everyone is vaccinated against the disease. Vaccines can also help to reduce the number of deaths from TB, and it is important to ensure that everyone is vaccinated against the disease. Vaccination is the best way to prevent TB, and it is important to ensure that everyone is vaccinated against the disease.The WHO is also working to improve access to TB diagnosis and treatment. The WHO has developed a Global Plan to End TB, which includes initiatives to increase access to diagnosis and treatment, strengthen public health systems, and promote research and innovation. The Global Plan also includes initiatives to improve the quality of care for people with TB and to reduce the stigma associated with the disease. To further support these goals, the WHO has launched several initiatives, such as the Stop TB Partnership, which brings together governments, international organizations, and civil society organizations to collaborate on TB control efforts. The WHO also works with national governments to ensure that TB prevention, diagnosis, and treatment services are available and accessible to all. Additionally, the WHO has developed guidelines and standards for the diagnosis and treatment of TB, as well as for the management of drug-resistant TB. The WHO is also working to expand access to new tools and treatments, such as rapid diagnostics and new drugs, to help improve the quality of care for people with TB. Finally, the WHO is working to reduce the stigma associated with TB, by raising awareness and educating the public about the disease. By taking these steps, the WHO hopes to make progress towards its goal of ending TB by 2030.The symptoms of TB can vary depending on the type of TB and the person’s age and health status. Common symptoms of TB include a persistent cough, chest pain, fever, night sweats, and weight loss. If left untreated, TB can cause serious complications and death. TB may also cause fatigue, chills, loss of appetite, coughing up blood, and swollen lymph nodes in the neck. More severe cases can lead to organ damage, including damage to the lungs, kidneys, and brain. If TB is left untreated, it can spread to other parts of the body, including the bones, joints, and nervous system. In some cases, TB can even be fatal. Treatment for TB typically involves a combination of antibiotics and other medications. It's important to take all medications as prescribed, as this will help to reduce the risk of complications and ensure that the infection is completely eliminated. Additionally, individuals with TB should practice good hygiene, such as washing their hands regularly and avoiding close contact with others. By taking the necessary precautions, individuals can help to reduce the spread of TB and ensure that they receive the appropriate treatment.The WHO is also playing a key role in improving global health. The WHO is working to promote access to healthcare, improve nutrition, reduce the spread of infectious diseases, and improve the quality of healthcare services around the world. The WHO is also working to reduce the burden of non-communicable diseases, such as cancer, diabetes, and cardiovascular disease. To achieve these goals, the WHO has established a number of initiatives, including the Global Health Security Agenda, the World Health Report, and the World Health Assembly. The Global Health Security Agenda is a global effort to strengthen public health systems and improve the global response to health threats. The World Health Report is an annual report that provides an overview of global health and outlines the challenges and opportunities for global health. The World Health Assembly is the decision-making body of the WHO and is responsible for setting the organization's policies and priorities. The WHO has also established a number of programs to address specific health issues, such as the Global Polio Eradication Initiative, the Global Fund to Fight AIDS, Tuberculosis and Malaria, and the Global Vaccine Action Plan. These programs are designed to improve access to health services, reduce the burden of disease, and improve the health of individuals and communities around the world. The WHO is committed to improving global health and ensuring that everyone has access to the healthcare they need.Vaccination is one of the most effective ways to protect against a wide range of diseases. Vaccines help to reduce the risk of serious illnesses and death from diseases like measles, polio, and whooping cough. Vaccination is especially important for middle-aged people, as they are more likely to be exposed to diseases due to their age and lifestyle. Vaccines are also beneficial for young children, as they can reduce the risk of serious infections and illnesses. Vaccines can help to protect against a variety of diseases, including influenza, mumps, rubella, and rotavirus. Vaccines can also help to prevent certain types of cancer, such as cervical cancer and liver cancer. Vaccines are safe and effective, and they provide protection against many serious and potentially deadly diseases. Vaccines can be administered in a variety of ways, including injections, nasal sprays, and oral drops. It is important to remember that vaccines do not provide complete protection against all diseases, so it is important to practice good hygiene and to get regular check-ups. Additionally, it is important to talk to your doctor about the risks and benefits of vaccination, and to make sure that you are up to date on all of your vaccinations. Vaccination is an important part of protecting yourself and your family from a wide range of serious illnesses and diseases.The WHO recommends that middle-aged people get vaccinated against a range of diseases, including influenza, measles, mumps, rubella, and whooping cough. The WHO also recommends that middle-aged people get vaccinated against pneumococcal disease, which can cause serious illnesses such as pneumonia and meningitis. Vaccinating against these illnesses is important for those in the middle-aged group, as it can help protect them from potential complications of the illnesses, as well as from the illnesses themselves. Vaccination can also help reduce the spread of these illnesses, as those who are vaccinated are less likely to spread them to others. Vaccinating against these illnesses is also important for those in the middle-aged group, as it can help protect them from serious illnesses, such as heart disease, stroke, and cancer, that can be caused by some of these illnesses. Vaccinating against pneumococcal disease is especially important for those in the middle-aged group, as it can help protect them from serious complications, such as meningitis, that can be caused by the disease. Vaccinating against these illnesses is also important for those in the middle-aged group, as it can help protect them from some of the more serious complications that can be caused by the diseases, such as sepsis and organ failure. Vaccinating against these illnesses is also important for those in the middle-aged group, as it can help protect them from the long-term effects of the illnesses, such as chronic fatigue syndrome, which can be caused by some of the illnesses. Vaccinating against these illnesses is also important for those in the middle-aged group, as it can help protect them from the complications that can be caused by some of the illnesses, such as hearing loss, blindness, and paralysis. Vaccinating against these illnesses is also important for those in the middle-aged group, as it can help protect them from the serious mental health problems that can be caused by some of the illnesses, such as depression and anxiety. Vaccinating against these illnesses is also important for those in the middle-aged group, as it can help protect them from the serious physical health problems that can be caused by some of the illnesses, such as arthritis and osteoporosis.The most effective vaccination programs for middle-aged people are those that are tailored to the individual’s age and health status. For example, people over the age of 65 may need additional vaccines, such as the shingles vaccine, to protect against shingles and other diseases. The WHO recommends that people over 65 get vaccinated against the flu, pneumococcal disease, hepatitis B, and human papillomavirus (HPV). Vaccination is also recommended for those with certain medical conditions, such as diabetes, heart disease, asthma, or a weakened immune system. Vaccines can help protect against serious illnesses and complications, and can help reduce hospitalizations and deaths related to those illnesses. Vaccination is also important for pregnant women, as certain vaccines can help protect both the mother and her unborn child. Vaccines can also help protect against certain cancers, such as cervical cancer caused by HPV. Vaccines can help protect against diseases such as measles, mumps, rubella, tetanus, diphtheria, pertussis, and meningitis. Vaccines can also help protect against certain types of hepatitis. Vaccines are generally safe and effective, and they are the best way to protect against serious diseases. Vaccines can help prevent the spread of disease, and can help protect the health of people in the community. Vaccines are an important part of preventive health care, and they can help keep people healthy and safe.The most up-to-date recommendations for vaccination for middle-aged people can be found on the WHO website. The WHO website provides detailed information about the recommended vaccines for middle-aged people, as well as information about the safety and effectiveness of the vaccines. The WHO also provides information about the cost of the vaccines, as well as information about where to get vaccinated. In addition, the WHO website provides resources to help middle-aged people understand the importance of getting vaccinated and the potential risks of not getting vaccinated. It also offers advice on how to talk to a doctor or healthcare provider about getting vaccinated. Furthermore, the WHO website provides information on the types of vaccines available, the recommended doses, and the recommended schedules for getting vaccinated. Additionally, the website provides information about the potential side effects of the vaccines and how to manage them. Finally, the WHO website provides information on how to store and dispose of used vaccines, as well as information about where to find more information about the different types of vaccines.The WHO also provides information about the potential side effects of the vaccines. Side effects from the vaccines are generally mild and may include redness, swelling, or pain at the injection site. It is important to follow the instructions provided by your doctor or healthcare provider when getting vaccinated. Vaccines are designed to protect individuals from the serious and sometimes life-threatening consequences of certain diseases. They work by stimulating the body’s natural immune response, which helps to protect against the disease. Vaccines are safe and effective, and they have helped to reduce the incidence of many infectious diseases. Vaccines are tested extensively to ensure their safety and efficacy. Vaccine safety monitoring is an ongoing process that involves monitoring the safety of vaccines after they are approved and available for use. The WHO works with countries and other partners to ensure that all vaccines used are of the highest quality and safety. Vaccine safety monitoring systems help to identify any potential safety concerns and take action if necessary. Vaccines can also help to reduce the spread of infectious diseases by reducing the number of people who are susceptible to the disease. Vaccines are most effective when given to people of all ages, including infants and the elderly. It is important for everyone to be vaccinated in order to reduce the spread of disease and protect public health. Vaccines can also help to reduce the economic burden of disease, as they can prevent hospitalizations and lost work days due to illness.Tuberculosis is a serious and potentially deadly disease, but it can be prevented and treated. The WHO is committed to providing global leadership in the fight against TB, and is working to improve access to diagnosis and treatment, strengthen public health systems, and promote research and innovation. Vaccination is an important part of protecting against TB and other diseases, and the WHO provides up-to-date recommendations for vaccination for middle-aged people. By following the WHO’s recommendations, middle-aged people can help protect themselves and their families from TB and other serious illnesses. To further reduce the risk of TB, the WHO also recommends that people get tested regularly for the disease. Early detection is key to successful treatment and can help reduce the spread of TB. Additionally, the WHO encourages people to practice good hygiene and to avoid contact with people who have active TB. Practicing good hygiene, such as washing hands regularly, can help prevent the spread of TB and other infectious diseases. With proper treatment and preventive measures, people can protect themselves, their families, and their communities from the devastating effects of TB.In addition to following the WHO’s recommendations for vaccination, middle-aged people can also take steps to reduce their risk of TB. These steps include avoiding contact with someone who has active TB, practicing good hygiene, and getting regular checkups. It is also important to be aware of the signs and symptoms of TB, so that if you do develop the disease, you can seek treatment as soon as possible. To further reduce the risk of TB, it is important to get adequate nutrition and rest. Eating a balanced diet and getting enough sleep can help boost the immune system and make it more difficult for TB bacteria to take hold. Additionally, those who are at higher risk for TB, such as those with HIV or diabetes, should get tested for TB on a regular basis. This will help ensure that any cases of TB can be identified and treated quickly. Finally, it is important to be aware of the risk factors for TB, such as living or working in crowded conditions, traveling to high-risk areas, or having contact with someone who has active TB. By taking these steps, middle-aged people can help reduce their risk of developing TB.By following the WHO’s recommendations for vaccination and taking steps to reduce their risk of TB, middle-aged people can help protect themselves and their families from TB and other serious illnesses. Vaccines are an important part of protecting against TB, and the WHO provides up-to-date recommendations for vaccination for middle-aged people. Following the WHO’s recommendations can help ensure that middle-aged people are protected against TB and other serious illnesses. Additionally, middle-aged people should take steps to reduce their risk of TB, such as getting tested for TB, avoiding contact with people who have TB, and staying away from places where TB is common. Furthermore, it is important to maintain a healthy lifestyle, including eating a balanced diet, exercising regularly, and getting enough sleep. Taking these steps can help to reduce the risk of TB and other serious illnesses, and can help to ensure that middle-aged people are able to live healthy and happy lives.  "

#txt = "Green tea is one of the most popular beverages in the world and has many health benefits. It is rich in antioxidants, which can help protect cells from damage and can help reduce inflammation. It can also help lower cholesterol levels, reduce the risk of heart disease, and may even help reduce the risk of certain types of cancer. Drinking green tea can also help improve cognitive performance, reduce stress levels, and improve energy levels. Core strength is an important part of overall fitness, and there are a variety of exercises that can help improve core strength. Planks, side planks, and mountain climbers are all great exercises for strengthening the core. Pilates and yoga can also help improve core strength and stability. Vitamins are essential for healthy aging, and the most important ones for seniors are vitamin D, vitamin B12, and omega-3 fatty acids. Vitamin D helps with calcium absorption, which is important for bone health, while vitamin B12 helps with nerve and brain function. Omega-3 fatty acids help reduce inflammation and improve cardiovascular health. Stress is an unavoidable part of life, but there are a number of ways to reduce stress levels. Exercise, meditation, and breathing exercises can all help to reduce stress levels. Spending time in nature, practicing mindfulness, and talking to a friend can also help reduce stress levels. Getting enough sleep is essential for good health, and the benefits of getting enough sleep include improved mood, better concentration, and better physical health. To get enough sleep, it is important to stick to a regular sleep schedule, avoid caffeine and alcohol before bedtime, and create a comfortable sleep environment. Vitamins can help boost immunity, and some of the best vitamins for boosting immunity include vitamin C, vitamin D, and zinc. Vitamin C helps to stimulate the production of white blood cells, which are essential for fighting infection. Vitamin D helps to regulate the immune system, and zinc helps to activate certain immune cells. Heart health is an important part of overall health, and there are a number of ways to improve heart health. Eating a healthy diet, exercising regularly, and avoiding smoking are all important steps to take to improve heart health. Taking steps to reduce stress levels and getting enough sleep can also help improve heart health. Healthy skin is an important part of overall health, and there are a number of foods that can help improve skin health. Foods that are high in antioxidants, such as berries, are great for skin health. Foods rich in omega-3 fatty acids, such as salmon and walnuts, can also help improve skin health. Improving balance is an important part of overall fitness, and there are a number of exercises that can help improve balance. Standing on one foot, walking heel to toe, and side-stepping are all great exercises for improving balance. Tai chi and yoga can also help improve balance. Digestive health is an important part of overall health, and there are a number of ways to improve digestive health. Eating a diet rich in fiber, drinking plenty of water, and avoiding processed foods can all help improve digestive health. Probiotics and fermented foods can also help improve digestive health. Overall, green tea, exercise, vitamins, stress reduction, sleep, and a healthy diet are all important for maintaining good health. Taking steps to improve core strength, heart health, skin health, balance, and digestive health can also help maintain good health."
def GetHeading(article):
    prompt = f"""Your task is to generate a heading of this article. The article type is a news. The heading should be engaging.
                article: ```{article}```
                Provide the heading in JSON format with the following key: Heading
            """
    return ChatGPT(prompt,1000)
def Create_Article_Docx(short_article, long_article):
    document = Document()  # Create a document object
    # Generate the title
    response = GetHeading(short_article)  # Get the heading of the article
    print(response)
    data = json.loads(response, strict=False)
    heading_txt = data["Heading"]  # Extract the heading text
    docx_title = heading_txt + ".docx"  # Specify the title of the generated Word document
    pdf_title = heading_txt + ".pdf"  # Specify the title of the generated PDF document

    print(heading_txt)

    heading = document.add_heading(level=0)  # Add a level 0 heading
    heading_run = heading.add_run(heading_txt)  # Set the content of the heading
    heading.alignment = WD_PARAGRAPH_ALIGNMENT.CENTER  # Center align the heading
    heading_run.font.name = 'Times New Roman'  # Set the font to Times New Roman
    heading_run.bold = True  # Set it as bold

    paragraph_list = long_article.split('\n')  # Split the long article into paragraphs by line breaks
    print(paragraph_list)

    for paragraph_txt in paragraph_list:  # Iterate through each paragraph text
        if paragraph_txt == '':
            continue
        paragraph = document.add_paragraph()  # Add a new paragraph
        paragraph.paragraph_format.first_line_indent = Pt(20)  # Set the first line indent to 20 points
        paragraph.alignment = WD_PARAGRAPH_ALIGNMENT.LEFT  # Left align the paragraph
        paragraph_run = paragraph.add_run(paragraph_txt)  # Set the content of the paragraph

        paragraph_run.font.size = Pt(12)  # Set the font size to 12 points
        paragraph_run.font.name = 'Times New Roman'  # Set the font to Times New Roman

    document.save("article.docx")

    # Convert the Word document to PDF
    convert("article.docx", "article.pdf")
    print("PDF saved!")

if __name__ == '__main__': 
    # document = Document()  # 新建文档对象
    Create_Article_Docx(short_article,long_article)
    # #生成标题
    # response = GetHeading(txt)
    # print(response)
    # data = json.loads(response,strict = False)
    # heading_txt = data["Heading"]
    # doxc_title = heading_txt + ".docx"
    # pdf_title = heading_txt + ".pdf"
    # print(heading_txt)
    
    # heading = document.add_heading(level = 0)#一级标题
    # heading_run = heading.add_run(heading_txt)#标题内容
    # heading.alignment = WD_PARAGRAPH_ALIGNMENT.CENTER#居中对齐
    # heading_run.font.name = 'Times New Roman'#字体
    # heading_run.bold = True #粗体

    # paragraph_list = txt.split('\n') #划分各段落
    # print(paragraph_list)
    # for paragraph_txt in paragraph_list:
    #     if(paragraph_txt == ''):
    #         continue
    #     paragraph = document.add_paragraph()
    #     paragraph.paragraph_format.first_line_indent = Pt(20)
    #     paragraph.alignment = WD_PARAGRAPH_ALIGNMENT.LEFT
    #     paragraph_run = paragraph.add_run(paragraph_txt)

    #     paragraph_run.font.size = Pt(12)
    #     paragraph_run.font.name = 'Times New Roman'#字体
    # document.save(doxc_title)  # 保存文档
    # convert(doxc_title,pdf_title)#docx转pdf